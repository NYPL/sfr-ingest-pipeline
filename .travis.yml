language: node_js
node_js:
- '10.15'
install: npm install
script: npm test
before_deploy: echo "All unit tests pass. Launching build on AWS EB."
deploy:
- provider: elasticbeanstalk
  skip_cleanup: true
  access_key_id: "$AWS_ACCESS_KEY_ID_DEVELOPMENT"
  secret_access_key: "$AWS_SECRET_ACCESS_KEY_DEVELOPMENT"
  region: us-east-1
  app: sfr-search-api
  env: sfr-search-api-dev
  bucket_name: elasticbeanstalk-us-east-1-224280085904
  bucket_path: sfr-search-api
  on:
    repo: NYPL/sfr-search-api
    branch: development
env:
  global:
  - secure: WpkWZka5/x3yijf0l00NvdyhwcundQ6P0eEJlehFyM+yVmOFXb0WR5kAdeHpC1+K9ey2+pcj0BELZKdbsleWYW2WKT9P/0OMH/kqPEvDmtKFOll7Fic/k9V/07JV3v8Pnr5/MDynCafjFzyMt/qbPNTTaCcm1oe+gqckimiD9Qj5ChOZSTU19YvB+ybXe339Rr5mkXYDYY1JaJUpmdDuhXMqRGqFwRajfwVJpswrAgp3wyb8qCI+4e7Mc84TekJ6Ixlk+qUOHL87OdEcyNVXLk/NtoYN/ncmYM7BsbYvSNZ5cSfTYc2Z+d8KLsK9MxpNf+HPdeQGVETZ3KvaesVSmxTurwI0d/YrrW0ukPXYb+ZErVA4AddQ+ejxnTdkF71OB0Gcr+1bF0EM4pp9PTsG1rdZI2PBBUL35RlYbuvR7o8D04j0YwAEA5jpng0vtjt5HwbP4XkRaPL3KFhlKUo8CXnt9xzPN3A/rqfXwuOY/muq0mrX7M3Gk9GJLr0dH+tVaWY/H54HNdnt/9Rbi3edS60TvvPJgnYrnf4L2cJ2EGbR0CtxEheNYb0UUqzP7tfojwKKvQCDZPeCgym6OKP4XxEY6H6aS/B/Pga0RZWN6m6keITexKjpinRoPjbgx3AwDuZZoH0xiVQnmlIp7ydgczvLRcOI/Q197vBBlTQ3hC4=
  - secure: aRAqPMFhYLzvVaQXptDH+aEMCq1z6gav5o2vF5ejMD4RNagSyxBfu74rwAV9sUZP0Hy+YcLKx4Qoh+ZXe8bycRhOuS0RPrVCPgpUp2BUIMeSZICAQXzp87d/hdKNN+bFUOiNF6gGLfTvtOqqKr8arZsrVq9X/ymwKy2GqXBydPkfDdU53BqQgiAyf3ss4+e/b4WXfNn4KS1cqUPQOC4HQueWzH1tNXBaxCNtFff4j4kDamRCbN7VB55o5RB0uo0gWiZKl+HZYa4sIzmzzzxCww9cwtR49tJtksnq+3W/n/S0ydnAXHoh6KTnPXK4xpTKZxMdedzGPeGspNPVvojCIsBFZhrAfWkqH8566MmvWS8XVIZoY++/tHTZDSqldpFYEMa/oGKdB9FzDZD6EfdwCCazWoFK5ob6c9E8j8Nc1jDTjIs0DOGspfxdio6B9nj9R/0Ut2/ipaun+m0gPcVcAsHScNE7bsh2XsZ9eKd+kAEAC6XEYARQsCtz2k/ib1oAvQGtcck0moDhE4QMwqrn5o3V4ratAw0zJLx/8dg5tuQAgF25nnIJZsnlX8XQe9TT4ElZwGFBb5tim0hOSX9S+FFECoEnERuKEkbcdRBfmDbL1ocjfT2/vFN3tYZdY6FWHa04CnkEkgFWJwsF4aQVoPdgDvTvNAoZrEEpJovARSM=
  - secure: qDx/PdUrD0o+KxIbC9Ua07PfeG+dNOpmEtVOcHwDzcoh9Ys+NFMNYmfqMiqioij3aBdgAJVJWyd2Xt8jn2rdZ1Qg639i1x/lpj0aSztOA5k5neebQnyNp0k1V14XuEWkRWMRHMTL3kxpmvLv780zlZYCgx4hWOI5gIVLYguTF0UcHpUU7t2vKHdd15Ac7zdPIebLyXcLl4jEXhV3JQhLsmVEE5dAkSPkovYZ/j45n8IijMLm1BJQcQJVVyjPklKjbYT3tsNGwGOVPyJaay1/hB8OioTSQ4aRlWP2bOjxWMY0eC7pWOI1mqWrfQ+m3uilkBA+augqzqa3gEDpP+5CPkaOKX+srXROUYCEONknUdMwGO6LJJOrHU61kA6OecmhUGIciNVmFEGYepY5vuYgOpEcOv/for3GJfesNsP1ToGxRIDF2x2HKWcdV/ATpoz3SLktiNeJDreSI6bDaLsD8PffbQDQa50kWPM67IdXTDWYflW9PUFP22zmIzN5T6B3+ecszAew3BEQ0XR9h31PW/v2sutTXRE4JFUFVRj3a9O3NO2/xNyA5lfY+vBSWknohUrSMZAB17C1nZ9s0pIooak/R0BADzq/1bhEyF5p4Zx1hnlQuTbnkQ2BWPq5oW8pEKMaViwp9iqLj4mK5CHFK/QQDhWxn5xEUqb2M9FqJn0=
  - ELASTICSEARCH_INDEX: sfr
  - ELASTICSEARCH_INDEX_V2: sfr_test
