language: node_js
node_js:
- '10.15'
install: npm install
script: npm test
before_deploy: echo "All unit tests pass. Launching build on AWS EB."
deploy:
- provider: elasticbeanstalk
  skip_cleanup: true
  access_key_id: "$AWS_ACCESS_KEY_ID_DEVELOPMENT"
  secret_access_key: "$AWS_SECRET_ACCESS_KEY_DEVELOPMENT"
  region: us-east-1
  app: sfr-search-api
  env: sfr-search-api-dev
  bucket_name: elasticbeanstalk-us-east-1-224280085904
  bucket_path: sfr-search-api
  on:
    repo: NYPL/sfr-search-api
    branch: development
env:
  global:
  - ELASTICSEARCH_INDEX: sfr
  - ELASTICSEARCH_INDEX_V2: sfr_test
  - secure: X5Drg3bwkfmimriX7B5pBacxCkbWqICuXdabbDOy+hBuULgrldDd8PTdfIBobFMUdf2K/BByxPv4RrACCtWR30nTJG1wVbLghfjzA7aANxOvQI4Nx0G4Az/vWpoqGzF/+mftpUaGGv8s7WI4jHuuLGej17NbG8lMAXOHU+fKqUMM3nq0jitxpPRN44TxT0z5N/esYdcXZT2mGTD9p6IfoXywJrfOpqY+jfQqc6p7BBlrQNay9T4E13v+hCurr5go2fw06HFP7G6+T8KM8QieOgJseXpD6KHdnVgcAo4WSEK44HWAuk2IP/DNDDG6ClUvLt47VxUsyIFV1iq/36dxiMybrDmqPZYSUcw/iH2+H8XzfSj7cZ6UwidsmjZI8Dt1OvZOBCRJhbFytvsLCrFHX9WPQ+B0+Q4ELKUzTkU1RHRSv5M/1FEJWcucMg4XW1axFw7eBQiMn9n8FJii+6iKQnYPFpoKghf/eegQTEQPJbuckqHIsAyXB9dWZUSeBwHrnPpVZw0+TkKpfrdGq6CZoxfxkySFd54voRzfe4iRkeWXZUr1ECUhM9v3VUNfENrzKeMTxKNJOrJG5UOjwILJ82T+uaHdMWKo8S3Q9GENuGoUhdYxvMegZoSpXOddSLTOciMO4he3Gf0jgwL8iF8pwvlhicyCFIbXWJrQPDeYH8A=
  - secure: clyEvDrQQDWkKJn/vgNF943CrxFPsag3d2JhAPRgsvVCJ75J3EWQCg45bIlHOqJW93/cojFIkjkjOrlpcmUU9XlT3NaV2I7H/anxfsoYdcxAlxtgn6aei2jmnYg3BCEewR4lH4BsGeQ2QIXliii8jzUDuhV6JtJLlT6qB2hDUYc1aZYJ4UFmY1PeR6BrOqsBEwCV95QNHzeq+OjZcyckGR33JZg4lEmkRNRXWy9KwLsPk3MFez05aiMnfg6a7NrgeWtZlWamZGrU4ZFLNPrtDf5I/P/ML7Ac312I2CxdcUMUkrnOl3ej7a34IpRp2mrv5pLeTrWqK6YCvS9HvIafLY3F3s66NNdSa9ZtsBy7+12hFTaE8/UzXmkJN76KS4/nsv7sK/z3uCDzyCe+RQAWmUAfkIht55YLDz2Tz722zFNFxvfNcfxh8HP226EGZ0Lj0gELXaA4MlyxIpL7lEu2Ct6EI07seoH1pofs7rMJ9F9Gi62w57KY9bA45cIqxe7CqncCtMtJhYOC6wdmoK5dJ5YoyuaXueCm+IACUufikEiI6OyJ/23HrOQ5M3MtTvlKrJ6XREm5KUGU1d++UfoDZ7epTFyOOXMTw/NtjAiUKxFeoIcRqvHN2EUpeazc4MEYZ/D2YdP8gQu7yaLhjoh2tc3AJwLQvG91bVEw/Rw9V4M=
  - secure: TMYtAc+fuEFWkUgiVk22bof+h1bZdjGWv1/Wwwr/q5Jl8uw1W/1pVRPubDsGuVgtKDJwR9kl4Pi+SW0soyvrtBtU0NkgpEG5AWWugGw8wYaBMlowy5Ir1G0+te/FB9G3rfn+aZNExK7rZEO/+YGHh2tWCa19I0rW55im0rijijFwdeRjGabGSPEsaQCDvP7F9nZKbNlXnmta66ENtdm1R5Pe/UHndknYgnhxQISS8SIKZZJop0kWBsfoIubG4Sf/fM7VKdPTQSa/54cwNIjSdguTxEJnZQBZsm3W+/otbysARC8SAMsI2TE0pHSb6U7a0AKsY7Xq5yzOrV8w8cRK4stSYljKxOroOMiw1CbobQcChI6ZL/dh6vO042OZqpetKH2tGu/NkQERMFwpegAQLVzlf7d0uIXLexuCdx/JnBOl/QdMMnXEsHoRmgYI+kiQBvwQOU6jDNVMm8V3WW8TC0h1J/+c9xct7CfSCZ3bZWh3/jEcXWezmw+so4UUkg7ej2WBYrWsS20Cl+sx8Q9FxIRh4hR2lpFjXDMbZv69jNfKxHvhrNN1SgjfjfR0a9hzTM9LFj/SThP2Kdw3AT22osV249D3rKT5KhoQPO4nzzD5DBurnDwjE/SDy8OXIGS1CqAStRPt/uZIUToVqR92DvY1UkXTQ7j6OXUje1T6lHQ=
